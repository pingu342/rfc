[The Key Agreement Schemes Validation System (KASVS)](http://csrc.nist.gov/groups/STM/cavp/key-establishment.html)

# 1 Introduction

このドキュメントは、鍵合意スキームの実装を検証する手順を規定する。
これには、SP 800-56Aで規定されている鍵確認なし及び鍵確認ありの鍵合意スキームを実装したIUT(Implementations Under Tests)のためのテストが包含されている。
KASVSは、IUT上で自動的にテストを実行できるような形で設計されている。

加えて、KASVSは、SP800-56Aが規定していないKDFを実装しているIUTのテストも提供している。
このために、CAVPは、"KDFを除いたSP800-56Aの全て"のテストと呼ばれるSP(special publication)を提供している。
このテストは、実装ガイドラインD.2において使用が認可されているKDF(これはSP800-56Aでは規定されていないAcceptable Key Establishment Protocolsと呼ばれるKDF)を使用しているIUT用である。

テストにはFunctionテストとValidityテストという2つのカテゴリがある。
Requirementと管理手順に続き、IUTの検証の探索を示す。
Requirementは、IUTとKASVSの間のデータ通信に関する規定と、IUTがPASSしなければならない検証テストの詳細と、KASVSの使用方法を記述する。


# 2 Scope

このドキュメントは、鍵確認なし及び鍵確認ありの鍵合意スキームに適合したSP800-56A実装を検証するためのテストと、"KDFを除いたSP800-56Aの全て"の実装を検証するためのテストを規定する。
このテストをIUTに適用するとき、KASVSは、鍵合意スキーム及び(もし適用可能であれば)鍵確認規定の実装の正しさを確認するためのテストを提供する。
IUTの実装の正しさの確認は、アルゴリズムレベルでアドレス可能な"shall"の文章で識別されるテスト要件と、規定によって識別される要件の両方を包んでいる。

Recommendation(NIST 800-56A)で詳述されているように、DLCはFFCとECCを含んでいる。
これらの暗号それぞれに対して分離された検証テストスイートが設計されている。
これらの検証テストスイートは、各鍵合意スキームに対する検証テストを含んでいる。
検証テストは、IUTがRecommendation(NIST 800-56A)の規定に従って鍵合意スキームのコンポーネントを実装していることを検証する。
これらのコンポーネントは、DLCプリミティブ(共有秘密Z)の計算や、KDFを通してのDKMの計算を含んでいる。
もし鍵確認がサポートされている場合、検証テストスイートは、IUTがRecommendation(NIST 800-56A)の規定通りに鍵確認のコンポーネントを実装していることを検証する。
これには、DKMの解析と、MacDataの生成と、MacTagの計算が含まれる。
アルゴリズムレベルでアドレス可能かつ"shall"の文章で識別された要件は、付録Bにリストされている検証テストによってテストされる。

もしIUTが、SP800-56Aで規定されていないKDFを実装している場合、"KDFを除いたSP800-56Aの全て"のコンポーネントテストがテストされる。

KASVSの検証プロセスは、実装に含まれている暗号機能の中で、SP800-56Aによって使用されているがSP(special publication)では定義されていない暗号機能について、その定義を要求する。
これらの機能は、なんの検証テストが必要とされるかをKASVSが決定するための情報として、KASVSに提供する。
加えて、これらの機能は、保障の獲得を助けるために使用される。(しかしこれはCAVPのスコープ外である)

鍵確認なしの検証テストは、MACアルゴリズムにテストを実行することを求めることに注意してください。
これは検証されたIUTを得るための必要条件ではない。
同様に、もし"KDFを除いたSP800-56Aの全て"がテストされる場合、テスト要件は共有秘密ZZがハッシュされることを要求する。
ハッシュ関数はテストを実行するためだけに使用され、検証されたIUTを得るための必要条件ではない。


# 6 Key Agreement Scheme Validation System (KASVS) Test

KASVSは、鍵合意及び鍵確認プロセスの実装がSP800-56Aと一致していることをテストする。

IUTへ適用時、KASVSは鍵合意スキーム仕様の実装の正しさを判断するためのテストを提供する。
Recommendation(NIST 800-56A)で規定されているように、離散対数暗号(DLC)は、有限体暗号(FFC)と楕円曲線暗号(ECC)を含んでいる。
検証テストスイートは、上記の各暗号タイプに対して設計され、分離されている。
各テストスイートは、(Recommendationで規定されている)各鍵合意スキームに対して設計されている。
各鍵合意スキームに対する検証テストスイートは、IUTが、Recommendationの規定通りに鍵合意スキームのコンポーネントを実装しれているかどうかを検証する。
これらのコンポーネントには、DLCプリミティブ(共有秘密Z)の計算、KDFによるDKMの計算が含まれる。
もし鍵確認がサポートされている場合、検証テストスイートはRecommendationの規定のとおりに鍵確認のコンポーネントが正しく実装されているかを検証する。
これには、DKMの解析、MacDataの生成、MacTagの計算を含まれる。

実装に含まれている暗号機能の内、SP800-56Aが使用する機能であるが、SP(special publication)では未定義の機能については、その機能の定義がなされなければならない。
これらの機能は、なんのテストが要求されるかをKASVSが判断するための情報を提供する。
加えて、これらの機能は、保障の獲得を助けるために使用されるかもしれない。(しかし保障のことはCAVPのスコープ外)
これらの機能には、ドメインパラメーター生成、ドメインパラメーター検証、鍵ペア生成、完全公開鍵検証、部分公開鍵検証(ECCのみ)、鍵再生成が含まれる。


## 6.1 Configuration Information

KASVSの検証プロセスを開始するために、ベンダーはアプリケーションを認可された研究所へ提出する。
ベンダの実装はIUTと呼ばれる。
テストを実行するための検証リクエストには、KASVSが必要とする情報と、IUTを記述する情報が含まれる。
もっと具体的には、検証リクエストは以下が含まれる。
...

1. ...

2. KASVSテストのためのコンフィグレーション情報

	a. IUTがサポートしている暗号スキーム。すなわち、FFCとECCの両方なのか、どちらかなのか。** FFCスキームはANS X9.42をベースとし、ECCスキームはANS X9.63をベースとしている。**

	b. 各アルゴリズムに対して、IUT内に含まれている暗号機能の内、SP800-56AでサポートされているがSPで未定義となっている暗号機能のリスト。...

3. もしFFCが実装されている場合、以下のコンフィグレーション情報が必要。

	a. サポートしている鍵合意スキーム

		dhHybrid1, MQV2, dhEphem, dhHybridOneFlow, MQV1, dhOneFlow, dhStatic

	b. サポートしている鍵同意の役割

		Initiator, Responder


## 6.2 The Function Test

... 


### 6.2.3 Testing of the 800-56A Processing through Shared Secret Computation (ZZ) for IUTs that do not use a KDF specified in 800-56A

分割されたファイルが、各鍵合意スキームと役割の組合せに対して生成される。
例えば、もしIUTがdhHybrid1鍵合意スキームをサポートしており、IUTがinitiatorとresponderの両方をサポートしている場合、2つのファイルが生成される。

KASFunctionTest_FFCHybrid1_NOKC_ZZOnly_init.req と、
KASFunctionTest_FFCHybrid1_NOKC_ ZZOnly_resp.req.

各リクエストファイル内に、...
これに加えて、もしFFCが使用される場合、ドメインパラメーター(p,g)の1セットが、10セットのデータで使用するために含まれている。
...
テストされるスキームに応じて、このデータのセットは、静的な公開鍵あるいは一時的な公開鍵を含んでいる。

IUTは、ドメインパラメーター値かNIST-approvedな曲線を、公開/秘密鍵ペアの生成に使用する。
IUTは、KASVSが供給する公開鍵と、自身の公開/秘密鍵ペアを使用して、共有秘密Zを計算する。
Zは、テストされるスキームに応じたDLCを使用して計算される。(NIST SP800-56Aの5.7セクション)
IUTは、Zを平文で出力すべきでないので、Zはハッシュされる。
このハッシュ実装はテスト用途のみで使用される。

IUTが生成した値は、SAMPLEファイルで規定された書式のRESPONSEファイルに保存される。

...


## 6.3 The Validity Test

CAVSツールから受信した、鍵確認なしまたは鍵確認ありの鍵合意プロセスによって生成された結果の有効、無効をIUTが理解する能力をテストすることが目的である。


### 6.3.3 Testing of the 800-56A Processing through Shared Secret Computation (ZZ) for IUTs that do not use a KDF specified in 800-56A

...


